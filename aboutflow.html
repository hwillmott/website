<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="headerblack.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Poiret+One">
        <script type="text/javascript" src="/scripts/processing.js"></script>
        <script type="text/javascript" src="/scripts/jprocessingjs-0.9.min.js"></script>
        <script type="text/javascript" src="/scripts/sitefunctions.js"></script>
    </head>

    <body style="margin:auto; width:800px;">
        <div id="headermenu"></div>
        <h2>About Flow Field</h2>
        <p>This sketch started with me wanting to simulate fish swimming around a pool of water. I really wanted the movement to look fluid. I was reading thround The Nature Of Code by Daniel Shiffman and I got to chapter 6, which has a section on flow fields. I had a lot of fun playing around with a 2D flow field using Perlin Noise, which looks something like the image below:</p>
        <img class="centeredImage" src="/images/flowfield.jpg"/>
        <p>I wanted the flow field to change gradually with time, like water or wind might, so I update the x and y parameters by a small amount with every draw cycle. At each draw cycle, the vector angle at each point in the grid is determined by the output of the Perlin Noise function using the x and y offsets, plus the x and y coordinate in the grid multiplied by a small factor. The Perlin Noise function always returns a value between 1 and 0, and will always return the same value for the same inputs. The nice thing about the Perlin Noise function is that it returns values that are close to each other, which generates natural-looking values. So, I took the output and mapped it to a range of angles that I wanted to control the direction of the flow, which is mostly left-pointing.</p>
        <p>Once I got something I sort of liked, I stopped drawing the flow field and instead dropped particles into the field and used the flow field vectors and a gravity constant to update their velocity at each draw cycle, so they appear to be drifting downwards. The particles have a mass and a starting velocity, and the flow field and gravity constant are just forces on the system. It was fun to revisit physics for this sketch. Getting the constants exactly right so that it looked good took a lot of trial and error, but I eventually came up with something I liked. The particles have a lifetime and slowly fade out as they fall down the screen, as I am drawing over a semitransparent background at each cycle.</p>
    </body
</html>